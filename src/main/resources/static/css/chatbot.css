/* chatbot.css - 가로형(Wide) + 높이 축소 버전 + 모바일 최적화 */

/* =========================
   1. 챗봇 컨테이너 (공통)
========================= */
#chatbot-container {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 9999;
    font-family: 'Noto Sans KR', 'Malgun Gothic', sans-serif;
}

/* =========================
   2. 토글 버튼 (90px)
========================= */
#chatbot-toggle-btn {
    width: 90px;
    height: 90px;
    background: transparent;
    border: none;
    box-shadow: none;
    border-radius: 0;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.2s ease;
}

#chatbot-toggle-btn:hover {
    transform: translateY(-3px);
}

#chatbot-toggle-btn:active {
    transform: translateY(0);
}

#chatbot-toggle-btn:focus-visible {
    outline: none;
    filter: drop-shadow(0 0 4px rgba(37,99,235,0.5));
}

#chatbot-toggle-btn .chatbot-icon-img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
    user-select: none;
    pointer-events: none;
    filter: drop-shadow(0 5px 15px rgba(37, 99, 235, 0.3));
    transition: filter 0.2s ease;
}

#chatbot-toggle-btn:hover .chatbot-icon-img {
    filter: drop-shadow(0 8px 20px rgba(37, 99, 235, 0.4));
}

/* =========================
   3. 채팅창 (PC 기준)
========================= */
#chatbot-window {
    position: absolute;
    bottom: 120px;
    right: 5px;

    /* PC: 가로 750px, 세로 585px */
    width: 750px;
    height: 585px;

    background: #ffffff;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);

    display: flex;
    flex-direction: row;
    overflow: hidden;

    opacity: 0;
    visibility: hidden;
    transform: translateY(20px);
    transition: all 0.25s ease;
}

#chatbot-window.visible {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

/* =========================
   4. 왼쪽: 캐릭터 영역 (Live2D)
========================= */
#live2d-stage {
    width: 300px;
    height: 100%;
    background: #eef2f8;
    border-right: 1px solid #e5e7eb;
    position: relative;
    overflow: hidden;
}

#live2d-canvas {
    width: 100%;
    height: 100%;
    display: block;
}

/* =========================
   5. 오른쪽: 채팅 UI 영역
========================= */
#chatbot-right-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    height: 100%;
    background: #ffffff;
}

/* 헤더 */
.chatbot-header {
    background: linear-gradient(90deg, #2F7BFF 0%, #1E5BFF 100%);
    color: #fff;
    padding: 14px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 800;
    font-size: 14px;
}

#chatbot-close-btn {
    background: none;
    border: none;
    color: #fff;
    font-size: 22px;
    cursor: pointer;
    line-height: 1;
}

/* 메시지 목록 */
#chatbot-messages {
    flex: 1;
    padding: 14px;
    overflow-y: auto;
    background: #ffffff;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.message {
    padding: 10px 12px;
    border-radius: 12px;
    font-size: 13px;
    line-height: 1.4;
    max-width: 85%;
    word-break: break-word;
    white-space: pre-line;
}

.bot-message {
    background: #f3f4f6;
    color: #333;
    border: none;
    align-self: flex-start;
}

.user-message {
    background: #2563EB;
    color: #ffffff;
    align-self: flex-end;
}

/* 입력 영역 */
.chatbot-input-area {
    padding: 12px;
    border-top: 1px solid #e5e7eb;
    display: flex;
    gap: 8px;
    background: #ffffff;
}

#chatbot-input {
    flex: 1;
    padding: 10px 12px;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    outline: none;
    font-size: 13px;
}

#chatbot-input:focus {
    border-color: #2563EB;
}

#chatbot-send-btn {
    padding: 0 16px;
    background: #2563EB;
    color: #ffffff;
    border: none;
    border-radius: 8px;
    font-weight: 700;
    font-size: 12px;
    cursor: pointer;
}

#chatbot-send-btn:hover {
    background: #1D4ED8;
}

/* =========================================================
   ✅ [Mobile Responsive] 모바일 화면 최적화 (768px 이하)
   - 캐릭터 영역 숨김
   - 화면 전체를 덮는 바텀 시트 스타일 적용
========================================================= */
@media (max-width: 768px) {

    /* 1. 챗봇 버튼 위치 조정 (우측 하단) */
    #chatbot-container {
        bottom: 15px;
        right: 15px;
    }

    /* 2. 토글 버튼 크기 축소 */
    #chatbot-toggle-btn {
        width: 60px;
        height: 60px;
    }

    /* 3. [핵심] 채팅창을 화면 꽉 차게 변경 (바텀 시트 스타일) */
    #chatbot-window {
        position: fixed !important; /* 부모 무시하고 화면 기준 배치 */
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;

        /* 상단 80px 정도 남기고 아래 꽉 채움 (키보드 대응 자동) */
        top: 80px !important;

        width: 100% !important;
        height: auto !important; /* top, bottom에 의해 높이 자동 결정 */

        border-radius: 20px 20px 0 0 !important;
        box-shadow: 0 -5px 25px rgba(0,0,0,0.2);
        margin: 0 !important;

        /* 애니메이션 방향 변경 (아래에서 위로) */
        transform: translateY(120%);
        transition: transform 0.3s cubic-bezier(0.25, 1, 0.5, 1);

        flex-direction: column; /* 세로 정렬 */
        z-index: 10000;
    }

    /* 열렸을 때 위치 복구 */
    #chatbot-window.visible {
        transform: translateY(0);
    }

    /* 4. 모바일에서는 Live2D 캐릭터 숨김 (공간 확보) */
    #live2d-stage {
        display: none !important;
    }

    /* 5. 오른쪽 패널 100% 확장 */
    #chatbot-right-panel {
        width: 100% !important;
        height: 100% !important;
        border-radius: 20px 20px 0 0;
    }

    /* 6. 터치 편의성을 위한 여백/폰트 조정 */
    .chatbot-header {
        padding: 15px;
        font-size: 16px;
    }

    #chatbot-close-btn {
        font-size: 24px;
        padding: 5px;
    }

    .chatbot-input-area {
        padding: 12px;
        background: #fff; /* 키보드 위 배경색 */
        padding-bottom: max(12px, env(safe-area-inset-bottom)); /* 아이폰 하단 바 대응 */
    }

    #chatbot-input {
        font-size: 16px; /* 모바일 확대 방지 */
        padding: 12px;
    }
}